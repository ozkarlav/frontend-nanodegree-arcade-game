var Enemy=function(y){this.speed=Math.random()*(maxSpeed-minSpeed)+minSpeed;this.x=-400;this.y=y;this.sprite="images/enemy-bug.png"};
Enemy.prototype.update=function(dt){if(this.x<505)this.x+=this.speed*dt;else{this.x=-1*(Math.random()*(800-200)+200);this.speed=Math.random()*(maxSpeed-minSpeed)+minSpeed}if(checkCollisions(player.x,player.y,this.x,this.y)){alert("Seems you just got bitten by a bug!");player.resetPlayer();jewel=randomJewel();heart=randomHeart();if(lives===0){score=0;lives=3;levels=1;resetSpeed();alert("GAME OVER")}else lives=lives-1}};
Enemy.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Jewel=function(x,y,sprite,value){this.x=x;this.y=y;this.sprite=sprite;this.value=value};Jewel.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};var Heart=function(x,y,sprite,name){this.x=x;this.y=y;this.sprite=sprite;this.name=name};Heart.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};
var Player=function(x,y){this.x=x;this.y=y;this.sprite="images/char-boy.png"};Player.prototype.render=function(){ctx.drawImage(Resources.get(this.sprite),this.x,this.y)};
Player.prototype.update=function(){if(checkCollisions(jewel.x,jewel.y,this.x,this.y)){jewel=new Jewel(-100,-100,"images/gem-orange.png",20);score=score+jewel.value}if(checkCollisions(heart.x,heart.y,this.x,this.y)){if(heart.name==="live"){lives=lives+1;heart=new Heart(-100,-100,"images/Heart.png",1)}if(heart.name==="dead"){this.resetPlayer();jewel=randomJewel();heart=randomHeart();if(lives===0){score=0;lives=3;resetSpeed();alert("GAME OVER")}else lives=lives-1}}};
Player.prototype.handleInput=function(direction){if(direction==="left"&&this.x>0)this.x-=102;if(direction==="up"){this.y-=82;score+=2}if(direction==="right"&&this.x<350)this.x+=102;if(direction==="down"&&this.y<400){this.y+=82;score=score-1}if(this.y<=0){this.resetPlayer();heart=randomHeart();jewel=randomJewel();score=score+50;levels+=1;minSpeed=minSpeed+50;maxSpeed=maxSpeed+50}};Player.prototype.resetPlayer=function(){this.x=200;this.y=400};var allEnemies=[];var enemy1=new Enemy(58);var enemy2=new Enemy(142);
var enemy3=new Enemy(225);allEnemies.push(enemy1,enemy2,enemy3);var minSpeed=100;var maxSpeed=300;var resetSpeed=function(){minSpeed=100;maxSpeed=300;return minSpeed;return maxSpeed};var player=new Player(200,400);
var randomJewel=function(){var allJewels=[];var xArray=[0,102,202,302,404];var yArray=[50,134,218];var xJewel=xArray[Math.floor(Math.random()*xArray.length)];var yJewel=yArray[Math.floor(Math.random()*yArray.length)];var jewel1=new Jewel(xJewel,yJewel,"images/gem-blue.png",5);var jewel2=new Jewel(xJewel,yJewel,"images/gem-green.png",10);var jewel3=new Jewel(xJewel,yJewel,"images/gem-orange.png",20);allJewels.push(jewel1,jewel2,jewel3);var jewel=allJewels[Math.floor(Math.random()*allJewels.length)];
return jewel};var jewel=randomJewel();var randomHeart=function(){var allhearts=[];var xArray=[0,102,202,302,404];var yArray=[74,158,242];var xHeart=xArray[Math.floor(Math.random()*xArray.length)];var yHeart=yArray[Math.floor(Math.random()*yArray.length)];var heart1=new Heart(xHeart,yHeart,"images/Heart.png","live");var heart2=new Heart(xHeart,yHeart,"images/poison_bottle.png","dead");allhearts.push(heart1,heart2);var heart=allhearts[Math.floor(Math.random()*allhearts.length)];return heart};
var heart=randomHeart();var lives=3;var score=0;var levels=1;function checkCollisions(x1,y1,x2,y2){if(x1<x2+60&&x1+60>x2&&y2<y1+50&&50+y2>y1)return true}document.addEventListener("keyup",function(e){var allowedKeys={37:"left",38:"up",39:"right",40:"down"};player.handleInput(allowedKeys[e.keyCode])});